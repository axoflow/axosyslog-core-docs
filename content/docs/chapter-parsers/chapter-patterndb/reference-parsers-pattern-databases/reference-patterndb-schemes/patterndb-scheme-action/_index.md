---
title: "Element: action"
weight:  2300
---
<!-- DISCLAIMER: This file is based on the syslog-ng Open Source Edition documentation https://github.com/balabit/syslog-ng-ose-guides/commit/2f4a52ee61d1ea9ad27cb4f3168b95408fddfdf2 and is used under the terms of The syslog-ng Open Source Edition Documentation License. The file has been modified by Axoflow. -->


## Location

/[patterndb]({{< relref "/docs/chapter-parsers/chapter-patterndb/reference-parsers-pattern-databases/reference-patterndb-schemes/patterndb-scheme-patterndb/_index.md" >}})/[ruleset]({{< relref "/docs/chapter-parsers/chapter-patterndb/reference-parsers-pattern-databases/reference-patterndb-schemes/patterndb-scheme-ruleset/_index.md" >}})/[actions]({{< relref "/docs/chapter-parsers/chapter-patterndb/reference-parsers-pattern-databases/reference-patterndb-schemes/patterndb-scheme-actions/_index.md" >}})/*action*



## Description

OPTIONAL â€” A container element describing an action that is performed when a message matching the rule is received.



## Attributes

  - *condition*: A `syslog-ng` filter expression. The action is performed only if the message matches the filter. The filter can include macros and name-value pairs extracted from the message. When using actions together with message-correlation, you can also use the `$(context-length)` macro, which returns the number of messages in the current context. For example, this can be used to determine if the expected number of messages has arrived to the context: `condition='"$(context-length)" \>= "5"'`

  - *rate*: Specifies maximum how many messages should be generated in the specified time period in the following format: `\<number-of-messages\>/\<period-in-seconds\>`. For example: `1/60` allows 1 message per minute. Rates apply within the scope of the context, that is, if `context-scope="host"` and `rate="1/60"`, then maximum one message is generated per minute for every host that sends a log message matching the rule. Excess messages are dropped. Note that when applying the rate to the generated messages, {{% param "product.abbrev" %}} uses the timestamps of the log messages, similarly to calculating the `context-timeout`. That way `rate` is applied correctly even if the log messages are processed offline.

  - *trigger*: Specifies when the action is executed. The `trigger` attribute has the following possible values:
    
      - *match*: Execute the action immediately when a message matching the rule is received.
    
      - *timeout*: Execute the action when the correlation timer ([`context-timeout`]({{< relref "/docs/chapter-parsers/chapter-patterndb/reference-parsers-pattern-databases/reference-patterndb-schemes/_index.md" >}})) of the pattern database rule expires. This is available only if actions are used together with correlating messages.



## Children

  - *create-context*

  - *message*: A container element storing the message to be sent when the action is executed. Currently {{% param "product.abbrev" %}} sends these messages to the `internal()` destination.
    
      - For details on the message context, see {{% xref "/docs/chapter-parsers/chapter-patterndb/configuring-pattern-databases/patterndb-correlation/_index.md" %}} and {{% xref "/docs/chapter-parsers/chapter-patterndb/patterndb-triggers-actions/patterndb-actions-correlation/_index.md" %}}. For details on triggering messages, see {{% xref "/docs/chapter-parsers/chapter-patterndb/patterndb-triggers-actions/_index.md" %}}
        
        {{% include-headless "chunk/option-inherit-mode.md" %}}
        
        This option is available in {{% param "product.abbrev" %}} 3.8 and later.
    
    <!-- end list -->
    
      - *inherit-properties*: This attribute is deprecated. Use the `inherit-mode` attribute instead.
        
        If set to `TRUE`, the original message that triggered the action is cloned, including its name-value pairs and tags.
        
        If set to `context`, {{% param "product.abbrev" %}} collects every name-value pair from each message stored in the context, and includes them in the generated message. If a name-value pair appears in multiple messages of the context, the value in the latest message will be used. Note that tags are not merged, the generated message will inherit the tags assigned to the last message of the context.
        
        For details on the message context, see {{% xref "/docs/chapter-parsers/chapter-patterndb/configuring-pattern-databases/patterndb-correlation/_index.md" %}} and {{% xref "/docs/chapter-parsers/chapter-patterndb/patterndb-triggers-actions/patterndb-actions-correlation/_index.md" %}}. For details on triggering messages, see {{% xref "/docs/chapter-parsers/chapter-patterndb/patterndb-triggers-actions/_index.md" %}}
        
        This option is available in {{% param "product.abbrev" %}} 5.3.2 and later.

  - *values*: A container element for values and fields that are used to create the message generated by the action.
    
      - *value*: Sets the value of the message field specified in the `name` attribute of the element. For example, to specify the body of the generated message, use the following syntax:
        
        ```c
        
            <value name="MESSAGE">A log message matched rule number $.classifier.rule_id</value>
        
        ```
        
        Note that currently it is not possible to add DATE, FACILITY, or SEVERITY fields to the message.
        
        When the action is used together with message correlation, the {{% param "product.abbrev" %}} application automatically adds fields to the message based on the `context-scope` parameter. For example, using `context-scope="process"` automatically fills the HOST, PROGRAM, and PID fields of the generated message.
    
      - *name*: Name of the message field set by the `value` element.



## Example

{{% include-headless "chunk/example-patterndb-actions.md" %}}

